# IAM (AWS Identify and Access Management)
## 概要
- 安全にAWS操作を実施するための認証・認可の仕組み

## 主要トピック
- IAMポリシー：アクセス権限を付与するための設定ドキュメント
- IAMユーザー：AWSアカウント内で追加されるユーザー
- IAMユーザーグループ：複数のIAMユーザーをまとめて権限付与することができる仕組み
- IAMロール：「AWSリソース（別アカウントのIAMユーザー）が別のリソースに対するアクセスする権限」を付与する仕組み

## 用語
- IAMリソース
    - ユーザー、グループ、ロール、ポリシー、IDプロバイダー
- IAMアイデンティティ
    - ユーザー、グループ、ロール
- IAMエンティティ
    - ユーザー、ロール
- プリンシパル
    - ルートユーザー、IAMユーザー、IAMロールを使用する人およびアプリケーション

## IAMポリシー
- 管理ポリシー：複数のエンティティにアタッチ可能
    - AWS管理ポリシー：AWSが管理しているポリシー
    - カスタマー管理ポリシー：AWSアカウントで管理するポリシー
- インラインポリシー：一つのエンティティにのみアタッチ可能

- ポリシーを設計する際は、AWS管理ポリシー→カスタマー管理ポリシーの順で検討する

## ポリシーのタイプ
- ユーザーベース（アイデンティティベース）のポリシー
    - アイデンティティにアタッチされるポリシー
    - IAMポリシー（管理ポリシー、インラインポリシー）のこと
    - そのアイデンティティが実行できる内容を指定できる
- リソースベースのポリシー
    - AWSリソースにアタッチされるポリシー
    - リソースに対するアクセス権限（S3バケットポリシー、ロールの信頼ポリシー）
    - JSON形式のドキュメントで定義されたインラインポリシーをリソースにアタッチして利用する

## ポリシー効果
- 許可ポリシー
    - AWSリソースへのアクセス許可・拒否を設定するIAMポリシー
- 信頼ポリシー
    - 特定のユーザーやリソースへのアクセスを許すための前提となる信頼を形成するためのポリシー

## アクティビティの記録ツール
- IAMアクセスアナライザー: 部外者アクセスの発見機能
- IAMアクセスアドバイザー: 内部ユーザーのアクセス範囲の確認機能
- Credential Report
- AWS Config
- AWS CloudTrail

## アクセス権限の境界設定
- Permissions boundary(権限境界)を設定して、付与可能な権限範囲を制限できる
    - IAMポリシーとPermissions boundaryの共有部分が利用可能な権限

## AWS Organizations
- 複数AWSアカウントの統合管理機能(IAMとは異なる機能)

- AWSアカウントの一元管理
- 新規アカウントの作成管理
- 請求管理

- 設定手順
    - AWSアカウントからマスターアカウントを選定する
    - マスターアカウントからOUにメンバーアカウントに招待する

- SCP (Service Control Policy)
    - OU内のメンバーに権限境界を設定することができる
    - ホワイトリスト形式(Allow)、ブラックリスト形式(Deny)どちらも設定できる
    - 複数設定できる。共有部分が権限範囲になる
    - 初期値は全てを許可する

- メンバーアカウント間でリソースを共有することができる